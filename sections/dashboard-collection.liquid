{% liquid
  assign blur_enabled = settings.enable_soft_blur | default: settings.enable_blur_effect | default: settings.enable_glass_blur
  assign radius_value = settings.global_radius | default: settings.global_border_radius | default: 18
  assign blur_value = settings.blur_strength | default: settings.glass_blur_strength | default: 10
  assign grid_cols_desktop = section.settings.grid_columns_desktop | default: 4
  assign grid_cols_mobile = section.settings.grid_columns_mobile | default: 1
%}
<section class="dashboard-shell" data-section-id="{{ section.id }}" style="--dashboard-radius: {{ radius_value }}px; --dashboard-blur: {{ blur_value }}px; --dashboard-cols-desktop: {{ grid_cols_desktop }}; --dashboard-cols-mobile: {{ grid_cols_mobile }};">
  <div class="dashboard-shell__inner">
    {% if section.settings.show_left_nav %}
      <aside class="dashboard-shell__nav glass-panel{% if blur_enabled %} is-blurred{% endif %}">
        <div class="dashboard-shell__brand">
          <span class="dashboard-shell__brand-title">{{ shop.name }}</span>
          <span class="dashboard-shell__brand-sub">{{ 'collections.general.title' | t }}</span>
        </div>
        <nav class="dashboard-shell__nav-list" aria-label="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©">
          {% for block in section.blocks %}
            {% if block.type == 'nav_item' %}
              <a class="dashboard-shell__nav-link" href="{{ block.settings.link }}" {{ block.shopify_attributes }}>
                {% if block.settings.icon != blank %}
                  <span class="dashboard-shell__nav-icon">{{ block.settings.icon }}</span>
                {% endif %}
                <span>{{ block.settings.label }}</span>
              </a>
            {% endif %}
          {% endfor %}
        </nav>
      </aside>
    {% endif %}

    <div class="dashboard-shell__content">
      {% if section.settings.show_filter_sidebar %}
        <aside class="dashboard-shell__filters glass-panel{% if blur_enabled %} is-blurred{% endif %}">
          <div class="dashboard-shell__filters-head">
            <h3 class="dashboard-shell__title">{{ 'collections.filters.title' | t }}</h3>
            {% if section.settings.show_sorting %}
              {%- render 'collection-page-toolbar', section: section, results: collection, animated: false, animation_effect: 'none' -%}
            {% endif %}
          </div>
          {% if collection.filters and collection.filters.size > 0 %}
            {%- render 'collection-filters-facets', results: collection, animated: false, animation_effect: 'none' -%}
          {% else %}
            <p class="dashboard-shell__muted">{{ 'collections.filters.empty' | t }}</p>
          {% endif %}
          {% for block in section.blocks %}
            {% if block.type == 'filter_group' %}
              <div class="dashboard-shell__custom-filter" {{ block.shopify_attributes }}>
                <div class="dashboard-shell__custom-filter-title">{{ block.settings.title }}</div>
                <div class="dashboard-shell__muted">{{ block.settings.source | capitalize }}</div>
              </div>
            {% endif %}
          {% endfor %}
        </aside>
      {% endif %}

      <div class="dashboard-shell__grid">
        {% paginate collection.products by section.settings.pagination_limit %}
          {% if collection.products.size == 0 %}
            <div class="dashboard-shell__empty glass-panel{% if blur_enabled %} is-blurred{% endif %}">
              <p>{{ 'collections.general.no_matches' | t }}</p>
            </div>
          {% else %}
            <div class="dashboard-shell__products" data-total-pages="{{ paginate.pages }}" data-product-container>
              {% for product in collection.products %}
                <article class="dashboard-card" data-product-card>
                  {% liquid
                    case settings.pcard_layout
                      when '1'
                        render 'product-card-1', product: product, section: section, index: forloop.index
                      when '2'
                        render 'product-card-2', product: product, section: section, index: forloop.index
                      when '3'
                        render 'product-card-3', product: product, section: section, index: forloop.index
                      when '4'
                        render 'product-card-4', product: product, section: section, index: forloop.index
                      when '5'
                        render 'product-card-5', product: product, section: section, index: forloop.index
                      else
                        render 'product-card-1', product: product, section: section, index: forloop.index
                    endcase
                  %}
                </article>
              {% endfor %}
            </div>
            {% if paginate.pages > 1 %}
              <div class="dashboard-shell__pagination">
                {%- render 'pagination', paginate: paginate, anchor: '' -%}
              </div>
            {% endif %}
          {% endif %}
        {% endpaginate %}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…ØªØ¬Ø± Ø¨Ù†Ù…Ø· Ø§Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_left_nav",
      "label": "Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„ÙŠØ³Ø±Ù‰",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_filter_sidebar",
      "label": "Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„ÙÙ„Ø§ØªØ±",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_sorting",
      "label": "Ø¥Ø¸Ù‡Ø§Ø± Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØªØ±ØªÙŠØ¨",
      "default": true
    },
    {
      "type": "range",
      "id": "grid_columns_desktop",
      "label": "Ø¹Ø¯Ø¯ Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (ÙƒÙ…Ø¨ÙŠÙˆØªØ±)",
      "min": 3,
      "max": 6,
      "step": 1,
      "default": 4
    },
    {
      "type": "range",
      "id": "grid_columns_mobile",
      "label": "Ø¹Ø¯Ø¯ Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (Ø¬ÙˆØ§Ù„)",
      "min": 1,
      "max": 2,
      "step": 1,
      "default": 1
    },
    {
      "type": "range",
      "id": "pagination_limit",
      "label": "Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„ÙƒÙ„ ØµÙØ­Ø©",
      "min": 6,
      "max": 48,
      "step": 6,
      "default": 24
    }
  ],
  "blocks": [
    {
      "type": "nav_item",
      "name": "Ø¹Ù†ØµØ± Ù‚Ø§Ø¦Ù…Ø© Ø¬Ø§Ù†Ø¨ÙŠØ©",
      "settings": [
        {
          "type": "text",
          "id": "icon",
          "label": "Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© (Ù†Øµ Ù‚ØµÙŠØ±)"
        },
        {
          "type": "text",
          "id": "label",
          "label": "Ø§Ù„Ù†Øµ"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Ø§Ù„Ø±Ø§Ø¨Ø·"
        }
      ]
    },
    {
      "type": "filter_group",
      "name": "Ù…Ø¬Ù…ÙˆØ¹Ø© ÙÙ„ØªØ±",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙ„ØªØ±"
        },
        {
          "type": "select",
          "id": "source",
          "label": "Ù…ØµØ¯Ø± Ø§Ù„ÙÙ„ØªØ±",
          "options": [
            { "value": "price", "label": "Ø§Ù„Ø³Ø¹Ø±" },
            { "value": "vendor", "label": "Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©" },
            { "value": "type", "label": "Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬" },
            { "value": "tag", "label": "ÙˆØ³Ù…" },
            { "value": "rating", "label": "Ø§Ù„ØªÙ‚ÙŠÙŠÙ…" }
          ]
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "ÙˆØ§Ø¬Ù‡Ø© Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",
      "blocks": [
        {"type": "nav_item", "settings": {"icon": "ğŸ ", "label": "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"}},
        {"type": "nav_item", "settings": {"icon": "â­", "label": "Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹"}},
        {"type": "filter_group", "settings": {"title": "Ø§Ù„Ø³Ø¹Ø±", "source": "price"}}
      ]
    }
  ]
}
{% endschema %}
